# Installation

This folder are generated by microgen. In order to run this GraphQL and Services, follow these steps:

- Install and run MongoDB on port 27017, for the database
- Install and run Redis on port 6379, for the service discovery
- Install NodeJs, run 
```
$ npm install
```
- Run the app
```
$ npm run dev
```
it will run the GraphQL Playground and some related microservices
- Access your GraphQL Playground at http://localhost:4000

Note: Your database will be named as per service name. For example your service name is "product", then your db will be "product-service"

# Schema

**Default Generated Schema**
Microgen generate User schema for You although You don't specify it on "schema.graphql". The User Schema generated are look like this:

```
type User {
    _id: String!
    email: String!
    password: String!
    firstName: String!
    lastName: String!
}

```

if you want to add some field inside user, you can simply set in on "schema.graphql" like this:

```
type User {
    phoneNumber: String
}
```

don't worry about the other fields, the default email, password, etc are still generated for You.

**Custom Directives**
- Default value
    ```
    @default(value: "someValue")
    ```
- Relation Delete Strategy
    - CASCADE: when related parent deleted, also delete its child
        ```
        @relation(onDelete: CASCADE)
        ```
    - RESTRICT: can't delete parent, when it had children
        ```
        @relation(onDelete: RESTRICT)
        ```
    - SET_NULL: when related parent deleted, set null to the FK relation
        ```
        @relation(onDelete: SET_NULL)
        ```
- Role
    - onCreate Own: means that every data created by logged in user, it automatically input userId in db table field (the userId are from token decryption)
        ```
        @role(onCreate: "own")
        ```
    - onUpdateDelete Own: means user only able delete or update his/her own data
        ```
        @role(onUpdateDelete: "own")
        ```
    - or you can specify both
        ```
        @role(onCreate: "own", onUpdateDelete: "own")
        ```

**Usage Example**
```
type Post{
    _id: String!
    text: String!
    comments: [Comment] @relation(onDelete: RESTRICT)
    author: User!  @role(onCreate: "own", onUpdateDelete: "own")
}

type UserFriend{
    _id: String
    user: User!
    friend: User!
}

type User{
    phoneNumbers: String!
}

type Comment {
    _id: String
    post: Post!
    text: String!
    author: User!  @role(onCreate: "own", onUpdateDelete: "own")
}
```
